<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    
    <title>Tsunamori&#39;s blog</title>
    
    
        <meta name="keywords" content="Tsunamori&#39;s blog">
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta property="og:type" content="website">
<meta property="og:title" content="Tsunamori&#39;s blog">
<meta property="og:url" content="https://tsunamori.github.io/page/2/index.html">
<meta property="og:site_name" content="Tsunamori&#39;s blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Tsunamori">
<meta name="twitter:card" content="summary">
    

    
        <link rel="alternate" href="/atom.xml" title="Tsunamori&#39;s blog" type="application/atom+xml">
    

    
        <link rel="icon" href="/favicon.ico">
    

    
<link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">

    
<link rel="stylesheet" href="/libs/open-sans/styles.css">

    
<link rel="stylesheet" href="/libs/source-code-pro/styles.css">


    
<link rel="stylesheet" href="/css/style.css">

    
<script src="/libs/jquery/2.1.3/jquery.min.js"></script>

    
<script src="/libs/jquery/plugins/cookie/1.4.1/jquery.cookie.js"></script>

    
    
        
<link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">

    
    
        
<link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">

    
    
    
    


    
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">Tsunamori&#39;s blog</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/">首页</a>
                
                    <a class="main-nav-link" href="/archives">归档</a>
                
                    <a class="main-nav-link" href="/categories">分类</a>
                
                    <a class="main-nav-link" href="/tags">标签</a>
                
                    <a class="main-nav-link" href="/about">关于</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="https://www.gravatar.com/avatar/bf0a499c8b2705f83e63c534d6cd38a2">
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search">
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/">首页</a></td>
                
                    <td><a class="main-nav-link" href="/archives">归档</a></td>
                
                    <td><a class="main-nav-link" href="/categories">分类</a></td>
                
                    <td><a class="main-nav-link" href="/tags">标签</a></td>
                
                    <td><a class="main-nav-link" href="/about">关于</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="Search">
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="https://www.gravatar.com/avatar/bf0a499c8b2705f83e63c534d6cd38a2?s=128">
            <h2 id="name">Tsunamori</h2>
            <h3 id="title">The green hat hacker</h3>
            <span id="location"><i class="fa fa-map-marker"></i>Moon the other side</span>
            <a id="follow" target="_blank" href="https://github.com/Tsunamori/" rel="external nofollow noopener noreferrer">FOLLOW</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                13
                <span>posts</span>
            </div>
            <div class="article-info-block">
                9
                <span>tags</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="https://github.com/Tsunamori" target="_blank" title="github" class="tooltip" rel="external nofollow noopener noreferrer">
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/atom.xml" target="_blank" title="rss" class="tooltip">
                            <i class="fa fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap" id="categories">
        <h3 class="widget-title">
            <span>categories</span>
            &nbsp;
            <a id="allExpand" href="#">
                <i class="fa fa-angle-double-down fa-2x"></i>
            </a>
        </h3>
        
        
        
         <ul class="unstyled" id="tree"> 
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            其它笔记
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/%E7%8E%B0%E9%98%B6%E6%AE%B5%E5%AF%B9blog%E7%9A%84%E8%A7%84%E5%88%92%E6%80%9D%E8%80%83/">现阶段对blog的规划思考</a></li>  <li class="file"><a href="/wiki/blog%E9%87%8D%E6%9E%84%E5%95%A6/">blog重构啦！</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            学习笔记
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/%E8%AF%95%E7%8E%A9Game-of-hacks/">Game of hacks 试玩</a></li>  <li class="file"><a href="/wiki/%E5%81%B7%E5%AD%A6%E7%9A%84%E6%B8%97%E9%80%8F%E5%B0%8Ftips/">偶然学到的渗透小tips</a></li>  <li class="file"><a href="/wiki/%E6%9C%8D%E5%8A%A1%E7%BD%91%E6%A0%BC%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">服务网格学习笔记</a></li>  <li class="file"><a href="/wiki/Chatgpt%E7%BF%BB%E8%AF%91%E5%A4%96%E6%96%87%E4%B9%A6%E7%B1%8D%E5%88%9D%E4%BD%93%E9%AA%8C/">Chatgpt翻译外文书籍初体验</a></li>  <li class="file"><a href="/wiki/Logseq%E4%BD%BF%E7%94%A8%E4%BD%93%E9%AA%8C/">Logseq使用体验</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            读书笔记
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/Notes_HowToHunt-md/">Notes for HowToHunt.md</a></li>  <li class="file"><a href="/wiki/Notes_0-to-1-the-road-of-CTFer_1/">0 to 1 the road of CTFer 第一章 Web入门</a></li>  <li class="file"><a href="/wiki/Notes_%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E4%BC%81%E4%B8%9A%E7%BA%A7web%E4%BB%A3%E7%A0%81%E5%AE%89%E5%85%A8%E7%BB%93%E6%9E%84/">代码审计 企业级web代码安全结构</a></li>  <li class="file"><a href="/wiki/Note-JAVA%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1-%E5%85%A5%E9%97%A8%E7%AF%87/">note_JAVA代码审计-入门篇</a></li>  </ul> 
                    </li> 
                    
                    <li class="directory">
                        <a href="#" data-role="directory">
                            <i class="fa fa-folder"></i>
                            &nbsp;
                            踩坑记录
                        </a>
                         <ul class="unstyled" id="tree">  <li class="file"><a href="/wiki/kali%E7%9A%84VPN%E4%BB%A3%E7%90%86%E8%BD%AF%E4%BB%B6%E9%80%89%E6%8B%A9/">在kali上安装clash/V2raya的教程</a></li>  <li class="file"><a href="/wiki/%E4%B8%80%E6%AC%A1%E5%B7%AE%E7%82%B9%E7%BF%BB%E8%BD%A6%E7%9A%84v2raya%E7%89%88%E6%9C%AC%E6%9B%B4%E6%96%B0%E7%BB%8F%E5%8E%86/">一次差点翻车的kali v2raya版本更新经历</a></li>  </ul> 
                    </li> 
                     </ul> 
    </div>
    <script>
        $(document).ready(function() {
            var iconFolderOpenClass  = 'fa-folder-open';
            var iconFolderCloseClass = 'fa-folder';
            var iconAllExpandClass = 'fa-angle-double-down';
            var iconAllPackClass = 'fa-angle-double-up';
            // Handle directory-tree expansion:
            // 左键单独展开目录
            $(document).on('click', '#categories a[data-role="directory"]', function (event) {
                event.preventDefault();

                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var subtree = $(this).siblings('ul');
                icon.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if (expanded) {
                    if (typeof subtree != 'undefined') {
                        subtree.slideUp({ duration: 100 });
                    }
                    icon.addClass(iconFolderCloseClass);
                } else {
                    if (typeof subtree != 'undefined') {
                        subtree.slideDown({ duration: 100 });
                    }
                    icon.addClass(iconFolderOpenClass);
                }
            });
            // 右键展开下属所有目录
            $('#categories a[data-role="directory"]').bind("contextmenu", function(event){
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconFolderOpenClass);
                var listNode = $(this).siblings('ul');
                var subtrees = $.merge(listNode.find('li ul'), listNode);
                var icons = $.merge(listNode.find('.fa'), icon);
                icons.removeClass(iconFolderOpenClass).removeClass(iconFolderCloseClass);
                if(expanded) {
                    subtrees.slideUp({ duration: 100 });
                    icons.addClass(iconFolderCloseClass);
                } else {
                    subtrees.slideDown({ duration: 100 });
                    icons.addClass(iconFolderOpenClass);
                }
            })
            // 展开关闭所有目录按钮
            $(document).on('click', '#allExpand', function (event) {
                event.preventDefault();
                
                var icon = $(this).children('.fa');
                var expanded = icon.hasClass(iconAllExpandClass);
                icon.removeClass(iconAllExpandClass).removeClass(iconAllPackClass);
                if(expanded) {
                    $('#sidebar .fa.fa-folder').removeClass('fa-folder').addClass('fa-folder-open')
                    $('#categories li ul').slideDown({ duration: 100 });
                    icon.addClass(iconAllPackClass);
                } else {
                    $('#sidebar .fa.fa-folder-open').removeClass('fa-folder-open').addClass('fa-folder')
                    $('#categories li ul').slideUp({ duration: 100 });
                    icon.addClass(iconAllExpandClass);
                }
            });  
        });
    </script>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title"><span>archives</span></h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">April 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">March 2023</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/02/">February 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/01/">January 2023</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">September 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/04/">April 2022</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">December 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">September 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">April 2021</a><span class="archive-list-count">2</span></li></ul>
        </div>
    </div>

    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
            <section id="main">
        <article id="post-试玩Game-of-hacks" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
                    <div class="article-meta">
                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">学习笔记</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link-link" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" rel="tag">代码审计</a>
    </div>

                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/wiki/%E8%AF%95%E7%8E%A9Game-of-hacks/">
            <time datetime="2021-07-15T16:44:14.000Z" itemprop="datePublished">2021-07-16</time>
        </a>
    </div>


                        
                            <i class="fa fa-bar-chart"></i>
                            <span id="busuanzi_container_site_pv"><span id="busuanzi_value_page_pv"></span></span>    
                        
                        
                            <div class="article-meta-button">
                                <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Tsunamori/Wiki-site/raw/writing/source/_posts/试玩Game-of-hacks.md"> Source </a>
                            </div>
                            <div class="article-meta-button">
                                <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Tsunamori/Wiki-site/edit/writing/source/_posts/试玩Game-of-hacks.md"> Edit </a>
                            </div>
                            <div class="article-meta-button">
                                <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Tsunamori/Wiki-site/commits/writing/source/_posts/试玩Game-of-hacks.md"> History </a>
                            </div>
                        
                    </div>
                
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/wiki/%E8%AF%95%E7%8E%A9Game-of-hacks/">Game of hacks 试玩</a>
        </h1>
    

            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
        
            
        
        
            <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>从Awesome-hacking_Cyber-skills看到的练习网站，粗略看了一下描述是关于代码审计的，正好一直在考虑提升一下代码审计的技能，最近就来试玩一下，顺便记录WP。</p>
<h3 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h3><p>一开始有难度选项，分别是beginner、intermediate和advanced。嗯，十分正常的分类。另外要选代码语言，一共十种，我比较在意的Android、Java、PHP、Python、.NET都在，令人满意。<br>看了题目大概是每次随机抽五道题+计时+提供选项，所以WP就先简单记一下代码，最后整理思路。</p>
<h3 id="PHP-代码审计"><a href="#PHP-代码审计" class="headerlink" title="PHP 代码审计"></a>PHP 代码审计</h3><h4 id="Beginner"><a href="#Beginner" class="headerlink" title="Beginner"></a>Beginner</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">int i;</span><br><span class="line">char inLine[64];</span><br><span class="line">cin &gt;&gt; inLine; &#x2F;&#x2F; 将cin的二进制码向右移动inLine位（或将cin十进制除以2 inLine次）,但是在这里没有用到。</span><br><span class="line">i &#x3D; atoi (inLine); &#x2F;&#x2F; atoi()：字符串转换整数</span><br><span class="line">sleep(i);</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dim myPassWord As String</span><br><span class="line">myPassWord &#x3D; &quot;12345&quot;</span><br></pre></td></tr></table></figure>
<p>use of hardcoded password</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Private Sub cmdRunNotePad_Click()</span><br><span class="line">Dim str As String</span><br><span class="line">MyVar &#x3D; window.Text()</span><br><span class="line">Sleep myVar+1</span><br><span class="line">dblNotePadID &#x3D; Sleep(myVar)</span><br><span class="line">End Sub</span><br></pre></td></tr></table></figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$dn &#x3D; $_GET[&#39;host&#39;];</span><br><span class="line">$filter&#x3D;&quot;(|(sn&#x3D;$person*)(givenname&#x3D;$person*))&quot;;</span><br><span class="line">$justthese &#x3D; array(&quot;ou&quot;, &quot;sn&quot;, &quot;givenname&quot;, &quot;mail&quot;);</span><br><span class="line">$sr&#x3D;ldap_search($ds, $dn, $dn, $justthese);</span><br><span class="line">$info &#x3D; ldap_get_entries($ds, $sr);</span><br><span class="line">echo $info[&quot;count&quot;].&quot; entries returned</span><br><span class="line">&quot;;?&gt;</span><br></pre></td></tr></table></figure>
<p>LDAP injection</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String url &#x3D; req.getRequestURL().toString();</span><br><span class="line">RequestDispatcher disp &#x3D; req.getRequestDispatcher(url.substring(url.lastIndexOf(req.getContextPath() + &quot;&#x2F;&quot;)</span><br><span class="line">+ req.getContextPath().length()));</span><br><span class="line">disp.forward(request, response);</span><br></pre></td></tr></table></figure>

            </div>
        
        <footer class="article-footer">
        </footer>
    </div>
</article>






    
        <article id="post-Notes_0-to-1-the-road-of-CTFer_1" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
                    <div class="article-meta">
                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link-link" href="/tags/CTF/" rel="tag">CTF</a>
    </div>

                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/wiki/Notes_0-to-1-the-road-of-CTFer_1/">
            <time datetime="2021-04-26T13:49:07.000Z" itemprop="datePublished">2021-04-26</time>
        </a>
    </div>


                        
                            <i class="fa fa-bar-chart"></i>
                            <span id="busuanzi_container_site_pv"><span id="busuanzi_value_page_pv"></span></span>    
                        
                        
                            <div class="article-meta-button">
                                <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Tsunamori/Wiki-site/raw/writing/source/_posts/Notes_0-to-1-the-road-of-CTFer_1.md"> Source </a>
                            </div>
                            <div class="article-meta-button">
                                <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Tsunamori/Wiki-site/edit/writing/source/_posts/Notes_0-to-1-the-road-of-CTFer_1.md"> Edit </a>
                            </div>
                            <div class="article-meta-button">
                                <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Tsunamori/Wiki-site/commits/writing/source/_posts/Notes_0-to-1-the-road-of-CTFer_1.md"> History </a>
                            </div>
                        
                    </div>
                
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/wiki/Notes_0-to-1-the-road-of-CTFer_1/">0 to 1 the road of CTFer 第一章 Web入门</a>
        </h1>
    

            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
        
            
        
        
            <h1 id="第一章-Web入门"><a href="#第一章-Web入门" class="headerlink" title="第一章 Web入门"></a>第一章 Web入门</h1><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><h3 id="敏感信息泄漏"><a href="#敏感信息泄漏" class="headerlink" title="敏感信息泄漏"></a>敏感信息泄漏</h3><h4 id="git泄漏"><a href="#git泄漏" class="headerlink" title="git泄漏"></a>git泄漏</h4><ol>
<li>常规git泄漏：flag在源码内，可直接利用工具或脚本获取。</li>
<li>git回滚：flag被修改，但依然保存在commit记录里。<ul>
<li>利用<code>git reset --hard [版本号]</code>获取flag。</li>
<li>更简单的方法是通过<code>git log-stat</code>查看每个commit修改了哪些文件，再用<code>git diff HEAD [commit-id]</code>比较当前版本和想看的commit之间的变化。</li>
</ul>
</li>
<li>git分支：命令<code>git reflog</code>查看分支间切换的记录。从原url下载分支内容并恢复（目前的恢复分支记录需要下载分支HEAD并修改GitHacker.py代码实现自动恢复分支，先简单记录下来，后续看是否有其它更简单的方式。）</li>
<li>git stash：stash是对当前工作的“保存”，以备后续恢复。<code>git stash list</code>查看保存的列表，<code>git stash pop</code>恢复工作现场，<code>git stash show</code>显示做了哪些改动。</li>
<li>git index：index是暂存区，用于通过git add .命令暂存新建文件等待commit。使用<code>git checkout-index</code>命令恢复文件。</li>
<li>git泄漏的其他利用方式：泄漏的git中也可能有其他有用的信息。<ul>
<li>.git/config文件夹中可能含有access_token信息，从而访问该用户的其它仓库。</li>
</ul>
</li>
</ol>
<h4 id="SVN泄漏"><a href="#SVN泄漏" class="headerlink" title="SVN泄漏"></a>SVN泄漏</h4><p>SVN是源代码版本管理软件，如果存在泄漏，可以利用.svn/entries或wc.db文件获取服务器源码等信息。</p>
<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/kost/dvcs-ripper">https://github.com/kost/dvcs-ripper</a></li>
<li>Seay-svn（Win）</li>
</ul>
<h4 id="HG泄漏"><a href="#HG泄漏" class="headerlink" title="HG泄漏"></a>HG泄漏</h4><p>.hg隐藏文件中包含代码和分支修改记录等信息。</p>
<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/kost/dvcs-ripper">https://github.com/kost/dvcs-ripper</a></li>
</ul>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>CTF线上赛往往会有重定向的问题，例如，只要访问<code>.git</code>便会返回403,此时访问<code>.git/config</code>，如果有文件内容返回，说明存在git泄漏，反之，一般不存在。而在SVN泄漏中，一般是在entries中爬取源代码，但有时会出现entries为空的情况，这时注意wc.db文件存在与否，便可通过其中的checksum在pristine文件夹中获取源代码。</p>
<h3 id="敏感备份文件"><a href="#敏感备份文件" class="headerlink" title="敏感备份文件"></a>敏感备份文件</h3><h4 id="gedit备份文件"><a href="#gedit备份文件" class="headerlink" title="gedit备份文件"></a>gedit备份文件</h4><p>在Linux下，用gedit编辑器保存文件后，当前目录下会生成一个<code>[文件名]~</code>的备份文件，访问这个文件即可获得文件内容。</p>
<h4 id="vim备份文件"><a href="#vim备份文件" class="headerlink" title="vim备份文件"></a>vim备份文件</h4><p>vim在意外退出时会生成一个备份文件，文件名格式为<code>.filename.swp</code>，再次生成备份文件时则为<code>.filename.swo</code>，第三次为<code>.filename.swn</code>，以此类推。恢复备份的办法是，先在当前目录下创建一个flag文件，再使用<code>vim-r flag</code>，即可恢复.flag.swp。</p>
<h4 id="常规文件"><a href="#常规文件" class="headerlink" title="常规文件"></a>常规文件</h4><p>主要靠丰富字典。(dirsearch+自己收集字典)</p>
<ul>
<li>phpinfo()</li>
<li>备份文件后缀<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">back.rar</span><br><span class="line">back.tar</span><br><span class="line">back.tar.gz</span><br><span class="line">back.zip</span><br><span class="line">backup.rar</span><br><span class="line">backup.tar</span><br><span class="line">backup.tar.gz</span><br><span class="line">backup.zip</span><br><span class="line">temp.rar</span><br><span class="line">temp.tar</span><br><span class="line">temp.tar.gz</span><br><span class="line">temp.zip</span><br><span class="line">web.rar</span><br><span class="line">web.tar</span><br><span class="line">web.tar.gz</span><br><span class="line">web.zip</span><br><span class="line">website.rar</span><br><span class="line">website.tar</span><br><span class="line">website.tar.gz</span><br><span class="line">website.zip</span><br><span class="line">www.rar</span><br><span class="line">www.tar</span><br><span class="line">www.tar.gz</span><br><span class="line">www.zip</span><br><span class="line">wwwroot.rar</span><br><span class="line">wwwroot.tar</span><br><span class="line">wwwroot.tar.gz</span><br><span class="line">wwwroot.zip</span><br><span class="line">index.php.bak</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a>总结</h4><p>线上赛过程中，出题人往往会在线运维题目，有时会导致swp备份文件的生成。所以读者在比赛过程中可以编写实时监控脚本，对题目服务进行监控。</p>
<h3 id="Banner识别"><a href="#Banner识别" class="headerlink" title="Banner识别"></a>Banner识别</h3><p>在线上赛中，网站的Banner对解题有着十分重要的作用，选手往往可以通过Banner信息来获得解题思路。<br>如得知网站是用ThinkPHP的Web框架编写时，我们可以尝试ThinkPHP框架的相关历史漏洞。或者得知这个网站是Windows服务器，那么我们在测试上传漏洞时可以根据Windows的特性进行尝试。</p>
<h4 id="自行收集指纹库"><a href="#自行收集指纹库" class="headerlink" title="自行收集指纹库"></a>自行收集指纹库</h4><ul>
<li>Github CMS指纹库</li>
<li>扫描器识别</li>
</ul>
<h4 id="使用已有工具"><a href="#使用已有工具" class="headerlink" title="使用已有工具"></a>使用已有工具</h4><ul>
<li>Wappalyzer（pip install python-Wappalyzer）：在data目录下，apps.json是其规则库，读者可以根据自己需求自由添加。</li>
</ul>
<h4 id="总结-2"><a href="#总结-2" class="headerlink" title="总结"></a>总结</h4><p>除了以上两种识别方式，我们还可以通过随意输入一些URL，观察404和302跳转页面中是否包含CMS及版本号。</p>
<h2 id="CTF中的SQL注入"><a href="#CTF中的SQL注入" class="headerlink" title="CTF中的SQL注入"></a>CTF中的SQL注入</h2><h3 id="SQL注入（mysql）"><a href="#SQL注入（mysql）" class="headerlink" title="SQL注入（mysql）"></a>SQL注入（mysql）</h3><h4 id="数字型注入"><a href="#数字型注入" class="headerlink" title="数字型注入"></a>数字型注入</h4><p>test.php?id=2 -&gt; true。返回记录。<br>test.php?id=3-1 -&gt; true，返回id=2的记录。<br>说明mysql对3-1进行了计算，从数字运算这个特征可以判断该注入点为数字型注入，输入点$_GET[‘id’]附近没有引号包裹，可以直接输入SQL查询语句。</p>
<p>mysql查询出两行记录（union select联合查询注入）但PHP源码限制只能显示一行记录的办法：<br>    1. 在原有数据后面加上<code>limit 1,1</code>参数，显示查询结果的第二条记录。<br>    1. 指定id=-1或一个很大的值，使第一条数据无法被查询到。（常用）</p>
<h4 id="字符型注入"><a href="#字符型注入" class="headerlink" title="字符型注入"></a>字符型注入</h4><p>与数字型注入相比，只是在GET参数输入的地方包裹了单引号（少部分情况为双引号）让其变成字符串。<br>在MySQL中，等号两边如果类型不一致则会发生强制转换，当数字和字符串数据比较时，字符串将被转换为数字再进行比较。<br>test.php?id=3-2，无返回结果，证明注入点不是数字型。继续尝试test.php?id=2a，返回id=2的结果，证明存在字符型注入。</p>
<pre><code>1. 尝试使用单引号闭合前面的单引号，（插入查询语句），再用`--%20`或`%23`注释后面的语句，注意在URL框输入时，`-- `和`#`以及`&#39;&#39;`要进行URL编码。
1. 除了注释，也可以使用单引号来闭合后面的单引号，eg: test.php?id=2&#39;union select xxx &#39;
</code></pre>
<h4 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h4><p>test.php?id=1’and’f’=’a’，猜中则返回id=1内容<br>更快的方法为 test.php?id=1’and’f’&lt;’n’，二分法。<br>如何获取每一位字符？利用mysql的substring(),mid(),substr()等。</p>
<h4 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h4><p>php?id=1’or sleep(10)</p>
<h4 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h4><p>mysql会将语句执行后的报错信息输出。<br>updatexml在执行时，第二个参数应该为合法的XPATH路径，否则会在引发报错时输出传入的参数。<br>id=’1’ or updatexml(1,concat(0x7e,(select pwd from wp_user)),1)<br>updatexml()报错注入，ref: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.csdn.net/qq_37873738/article/details/88042610">https://blog.csdn.net/qq_37873738/article/details/88042610</a></p>
<h4 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h4><p>当目标开启多语句执行时，可以采用多语句执行的方式修改数据库结构和数据。</p>
<h3 id="注入点"><a href="#注入点" class="headerlink" title="注入点"></a>注入点</h3><h4 id="注入点在select-expr"><a href="#注入点在select-expr" class="headerlink" title="注入点在select_expr"></a>注入点在select_expr</h4><p>AS别名：id=(select%20pwd%20from%20wp_user)%20as%20title</p>
<h4 id="注入点在table-reference"><a href="#注入点在table-reference" class="headerlink" title="注入点在table_reference"></a>注入点在table_reference</h4><p>仍可以用别名取出数据：SELECT title FROM (SELECT pwd AS title FROM wp_user)x;</p>
<p>在该两处的注入，如果注入点有反引号包裹，那么需要先闭合反引号。</p>
<h4 id="注入点在WHERE或HAVING后"><a href="#注入点在WHERE或HAVING后" class="headerlink" title="注入点在WHERE或HAVING后"></a>注入点在WHERE或HAVING后</h4><p>代码：<code>$res = mysqli_query($conn, &quot;SELECT title FROM wp_news WHERE id = $&#123;_GET[id]&#125;&quot;);</code><br>现实中最常遇到的情况，要先判断有无引号包裹，再闭合前面可能存在的括号，即可进行注入来获取数据。</p>
<p>注入点在HAVING后的情况与之类似。</p>
<h4 id="注入点在GROUP-BY或ORDER-BY后"><a href="#注入点在GROUP-BY或ORDER-BY后" class="headerlink" title="注入点在GROUP BY或ORDER BY后"></a>注入点在GROUP BY或ORDER BY后</h4><p>当遇到不是WHERE后的注入点时，先在本地MySQL中进行尝试，看语句后面能加什么，从而判断当前可以注入的位置，进而进行有针对的注入。</p>
<p>假设代码如下：<code>$res = mysqli_query($conn, &quot;SELECT title FROM wp_news GROUP BY $&#123;_GET[&#39;title&#39;]&#125;&quot;);</code><br>测试可得，title=id desc,(if(1,sleep(1),1))，可以利用时间注入获取数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">事实上只要对输入值进行白名单比对，基本就能防御这种注入。</span><br></pre></td></tr></table></figure>

<h4 id="注入点在LIMIT后"><a href="#注入点在LIMIT后" class="headerlink" title="注入点在LIMIT后"></a>注入点在LIMIT后</h4><p>该注入比较简单，通过更改数字大小，页面会显示更多或更少的记录数。由于语法限制，LIMIT后只能是数字，在整个SQL语句没有ORDER BY关键字的情况下，可以直接使用UNION注入。另外可以根据SELECT语法，通过加入PROCEDURE来尝试注入（只适用于MySQL 5.6前的版本）</p>
<h3 id="INSERT注入"><a href="#INSERT注入" class="headerlink" title="INSERT注入"></a>INSERT注入</h3><p>通常注入位于字段名或字段值的地方，且没有回显信息。</p>
<h4 id="注入点位于tbl-name"><a href="#注入点位于tbl-name" class="headerlink" title="注入点位于tbl_name"></a>注入点位于tbl_name</h4><p>如果能够通过注释符注释后续语句，则可直接插入特定数据到想要的表内，如管理员表。</p>
<h4 id="注入点位于VALUES"><a href="#注入点位于VALUES" class="headerlink" title="注入点位于VALUES"></a>注入点位于VALUES</h4><h3 id="UPDATE注入"><a href="#UPDATE注入" class="headerlink" title="UPDATE注入"></a>UPDATE注入</h3><h3 id="DELETE注入"><a href="#DELETE注入" class="headerlink" title="DELETE注入"></a>DELETE注入</h3><p>对id参数进行注入时，如果使WHERE后的值变为true，数据就会被删除。为了保证正常数据不会被干扰，通常使用<code>and sleep (1)</code>保证WHERE后的结果返回为false，让语句无法成功执行，后续步骤参考时间盲注。</p>
<h2 id="注入防御及绕过思路"><a href="#注入防御及绕过思路" class="headerlink" title="注入防御及绕过思路"></a>注入防御及绕过思路</h2><p>其它ref：<a target="_blank" rel="external nofollow noopener noreferrer" href="https://blog.csdn.net/wy_97/article/details/78085664">https://blog.csdn.net/wy_97/article/details/78085664</a></p>
<h3 id="关键字替换或匹配拦截"><a href="#关键字替换或匹配拦截" class="headerlink" title="关键字替换或匹配拦截"></a>关键字替换或匹配拦截</h3><h4 id="过滤空格"><a href="#过滤空格" class="headerlink" title="过滤空格"></a>过滤空格</h4><p>替代空格的空白符有：<code>%0a, %0b, %0c, %0d, %09, %a0</code>（均为URL编码，%a0在特定字符集才能利用）和<code>/**/</code>组合、括号等。</p>
<h4 id="将SELECT替换成空"><a href="#将SELECT替换成空" class="headerlink" title="将SELECT替换成空"></a>将SELECT替换成空</h4><p>可以采用嵌套的方式，如SESELECTLECT。</p>
<h4 id="大小写匹配"><a href="#大小写匹配" class="headerlink" title="大小写匹配"></a>大小写匹配</h4><p>在MySQL中，关键字是不区分大小写的，如果只匹配了SELECT就可以通过大小写混写的方式绕过。</p>
<h4 id="正则匹配"><a href="#正则匹配" class="headerlink" title="正则匹配"></a>正则匹配</h4><p>正则匹配关键字<code>\bselect\b</code>可以用形如<code>/*!50000select*/</code>的方式绕过。</p>
<h4 id="替换了单引号或双引号，没有过滤反斜杠"><a href="#替换了单引号或双引号，没有过滤反斜杠" class="headerlink" title="替换了单引号或双引号，没有过滤反斜杠"></a>替换了单引号或双引号，没有过滤反斜杠</h4><p><code>id=&#39;a\&#39; AND title = &#39;OR sleep(1)#&#39;</code><br>反斜杠转义了预置的单引号，实现绕过。</p>
<h3 id="逃逸引号"><a href="#逃逸引号" class="headerlink" title="逃逸引号"></a>逃逸引号</h3><h4 id="编码解码"><a href="#编码解码" class="headerlink" title="编码解码"></a>编码解码</h4><p>当用户输入待转义函数时，如果数据处于编码状态则引号无法被转义。<br>同样的情况也发生在加密/解密、字符集转换的情况。</p>
<ul>
<li>宽字节注入</li>
</ul>
<h4 id="意料之外的输入点"><a href="#意料之外的输入点" class="headerlink" title="意料之外的输入点"></a>意料之外的输入点</h4><p>被遗漏的可控点，例如PHP中，上传的文件名、http header、$_SERVER[‘PHP_SELF’] 等变量。</p>
<h4 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h4><p>由于开发者信任数据库中取出的数据是无害的，从而导致二次注入漏洞的出现。</p>
<ul>
<li> 用户名为<code>admin&#39;or&#39;1</code></li>
</ul>
<h4 id="字符串截断"><a href="#字符串截断" class="headerlink" title="字符串截断"></a>字符串截断</h4><p>在标题、抬头等位置，开发者可能限制其字符不能超过x个字符，超过就会被截断。<br>假如攻击者输入<code>aaaa&#39;</code>，自动转义为<code>aaaa\&#39;</code>，由于长度限制被截取为<code>aaaa\</code>，正好转义预置的单引号，实现注入。</p>
<h3 id="注入应用"><a href="#注入应用" class="headerlink" title="注入应用"></a>注入应用</h3><ul>
<li>在有写文件权限的情况下，直接用INTO OUTFILE或DUMPFILE向Web目录写文件，或写文件后结合文件包含漏洞实现代码执行。ref:<a target="_blank" rel="external nofollow noopener noreferrer" href="https://baijiahao.baidu.com/s?id=1650711425682220792&amp;wfr=spider&amp;for=pc">https://baijiahao.baidu.com/s?id=1650711425682220792&amp;wfr=spider&amp;for=pc</a></li>
<li>在有读文件权限的情况下，用load_file()函数读取网站源码和配置信息，获取敏感数据。</li>
<li>提升权限，绕过登录，添加用户，调整用户权限。</li>
<li>通过数据，控制如缓存、模板等文件内容来获取权限，或者删除、读取某些关键文件。</li>
<li>在可以执行多语句的情况下，控制整个数据库，包括控制任意数据、任意字段长度等。</li>
<li>在SQL Server这类数据库中可以直接执行系统命令。</li>
</ul>
<h3 id="总结-3"><a href="#总结-3" class="headerlink" title="总结"></a>总结</h3><p>实际比赛中，应根据不同的SQL服务器类型查找相关资料，通过fuzz得出被过滤的字符、函数、关键词等，在文档中查找未过滤的替代，完成绕过。</p>
<ul>
<li>练习靶场：github-sqli-labs</li>
</ul>
<h2 id="任意文件读取漏洞"><a href="#任意文件读取漏洞" class="headerlink" title="任意文件读取漏洞"></a>任意文件读取漏洞</h2><h3 id="文件读取漏洞常见触发点"><a href="#文件读取漏洞常见触发点" class="headerlink" title="文件读取漏洞常见触发点"></a>文件读取漏洞常见触发点</h3><h4 id="PHP"><a href="#PHP" class="headerlink" title="PHP"></a>PHP</h4><p>有关文件读取的标准函数（审计中重点关注）。<br>包括但不限于：</p>
<ul>
<li><code>file_get_contents(),file(),fopen()</code>函数，(及其文件指针操作函数fread(),fgets()等);</li>
<li>与文件包含相关的函数<code>include(),require(),include_once(),require_once()</code>等;</li>
<li>通过PHP读文件的执行系统命令：<code>system(),exec()</code>等。<br>PHP扩展中读取文件的函数：</li>
<li>php-curl扩展</li>
<li>XML模块XXE</li>
</ul>
<p>相关源码阅读：Wrapper和Filter</p>
<p>PHP文件包含的实际问题：<br>    1. 文件路径前面可控，后面不可控：在较低PHP及容器版本中可以使用<code>\x00</code>截断，对应的URL编码是<code>%00</code>。当服务端存在文件上传功能时，也可以尝试利用zip或phar协议直接进行文件包含执行PHP代码。<br>    1. 文件路径后面可控，前面不可控：通过<code>../</code>进行目录穿越读取文件，但这种情况无法使用Wrapper，如果服务器是利用include等文件包含类的函数，将无法读取PHP文件中的PHP代码。<br>    1. 文件路径中间可控：和第一种相似，但无法利用Wrapper进行文件包含。</p>
<h4 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h4><p>漏洞经常出现在框架请求静态资源文件部分，也就是最后读取文件内容的open函数。但直接导致漏洞的原因往往是Python函数的feature被忽略。</p>
<p>除了Python框架，很多其它涉及文件操作的应用也可能因为滥用open函数、模板的不当渲染导致任意文件读取。</p>
<h4 id="JAVA"><a href="#JAVA" class="headerlink" title="JAVA"></a>JAVA</h4><ul>
<li>文件读取函数FileInputStream</li>
<li>XXE</li>
<li>JAVA模块所支持的<code>file://</code>协议</li>
<li>Spring Cloud Config Server 路径穿越与任意文件读取漏洞 CVE-2019-3799, Jenkins 任意文件读取漏洞 CVE-2018-1999002</li>
</ul>
<h4 id="Ruby"><a href="#Ruby" class="headerlink" title="Ruby"></a>Ruby</h4><ul>
<li>通常与Rails框架相关。</li>
<li>Ruby on Rails 远程代码执行漏洞 CVE-2016-0752，Ruby on Rails 路径穿越与任意文件读取漏洞 CVE-2018-3760，Ruby on Rails 路径穿越与任意文件读取漏洞 CVE-2019-5418</li>
</ul>
<h4 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h4><ul>
<li>通常为模板注入、代码注入等。</li>
<li>Node.js express 模块任意文件读取漏洞 CVE-2017-14849</li>
</ul>
<h3 id="中间件-服务器相关"><a href="#中间件-服务器相关" class="headerlink" title="中间件/服务器相关"></a>中间件/服务器相关</h3><h4 id="Nginx错误配置"><a href="#Nginx错误配置" class="headerlink" title="Nginx错误配置"></a>Nginx错误配置</h4><p>常搭配Python-Web应用一起出现。</p>
<ul>
<li>/static../ -&gt; /home/myapp/static/../，产生目录穿越，穿越至myapp目录。原因：location最后没有加‘/’限制<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location &#x2F;static &#123;</span><br><span class="line">  alias &#x2F;home&#x2F;myapp&#x2F;static&#x2F;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h4><p>MySQL：</p>
<ul>
<li>load_file(),利用条件严格，但仍然常出相关文件读取题目。</li>
<li>load data infile，需要执行完整的SQL语句且需要FILE权限，比较少见，除了SSRF攻击MySQL以外，很少能够直接执行整条非基本SQL语句的机会。</li>
</ul>
<h4 id="软链接"><a href="#软链接" class="headerlink" title="软链接"></a>软链接</h4><p>又称符号链接，即soft link或symbolic link。相当于win下的快捷方式。</p>
<p>硬链接与软链接的区别： <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.jianshu.com/p/b035d94fa959">https://www.jianshu.com/p/b035d94fa959</a></p>
<p>bash命令<code>ln-s</code>可以创建一个指向指定文件的软链接文件，然后将该文件上传至服务器，访问该链接文件时，实际上是在请求服务端它指向的文件。</p>
<h4 id="FFmpeg"><a href="#FFmpeg" class="headerlink" title="FFmpeg"></a>FFmpeg</h4><p>CISCN 2017 FFmpeg 任意文件读取漏洞</p>
<h4 id="Doker-API"><a href="#Doker-API" class="headerlink" title="Doker-API"></a>Doker-API</h4><p>Docker-API可以控制Docker的行为，Docker-API通过UNIX Socket通信，也可以通过HTTP直接通信。当可以通过SSRF漏洞进行UNIX Socket通信时，就可以通过操纵Docker-API把本地文件载入Docker新容器进行读取（利用Docker的ADD、COPY操作）。</p>
<h3 id="客户端相关"><a href="#客户端相关" class="headerlink" title="客户端相关"></a>客户端相关</h3><p>客户端文件读取漏洞，大多基于XSS读取本地文件。</p>
<h4 id="浏览器-Flash-XSS"><a href="#浏览器-Flash-XSS" class="headerlink" title="浏览器/Flash XSS"></a>浏览器/Flash XSS</h4><p>js读取本地文件</p>
<ul>
<li>Safari浏览器 客户端本地文件读取漏洞</li>
</ul>
<h4 id="MarkDown语法解析器XSS"><a href="#MarkDown语法解析器XSS" class="headerlink" title="MarkDown语法解析器XSS"></a>MarkDown语法解析器XSS</h4><p>具有解析js的能力，且缺乏浏览器的读取本地文件限制。</p>
<h2 id="文件读取漏洞常见读取路径"><a href="#文件读取漏洞常见读取路径" class="headerlink" title="文件读取漏洞常见读取路径"></a>文件读取漏洞常见读取路径</h2><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><h4 id="flag名称（相对路径）"><a href="#flag名称（相对路径）" class="headerlink" title="flag名称（相对路径）"></a>flag名称（相对路径）</h4><p>fuzz方式获取</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag(.txt|.php|.pyc|.py ...)</span><br><span class="line">flag(.txt|.php|.pyc|.py ...)</span><br><span class="line">[dir_you_know]&#x2F;flag(.txt|.php|.pyc|.py ...)</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;flag(.txt|.php|.pyc|.py ...)</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;tmp&#x2F;flag(.txt|.php|.pyc|.py ...)</span><br><span class="line">..&#x2F;flag(.txt|.php|.pyc|.py ...)</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;root&#x2F;flag(.txt|.php|.pyc|.py ...)</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;home&#x2F;flag(.txt|.php|.pyc|.py ...)</span><br><span class="line">..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;home&#x2F;[user_you_know]&#x2F;flag(.txt|.php|.pyc|.py ...)</span><br></pre></td></tr></table></figure>

<h4 id="服务器信息（绝对路径）"><a href="#服务器信息（绝对路径）" class="headerlink" title="服务器信息（绝对路径）"></a>服务器信息（绝对路径）</h4><p>CTF中常见的部分须知目录和文件</p>
<ol>
<li>/etc目录<br> 多是各种应用或系统配置文件，是进行文件读取的首要目标。</li>
<li>/etc/passwd （详细解析：<a target="_blank" rel="external nofollow noopener noreferrer" href="http://c.biancheng.net/view/839.html%EF%BC%89">http://c.biancheng.net/view/839.html）</a><br> Linux系统保存用户信息及其工作目录的文件，所有用户/组可读，一般用作Linux系统下文件读取漏洞存在判断的基准。从该文件可得系统中存在哪些用户，及其所属组和工作目录。</li>
<li>/etc/shadow （详细解析： <a target="_blank" rel="external nofollow noopener noreferrer" href="http://c.biancheng.net/view/840.html%EF%BC%89">http://c.biancheng.net/view/840.html）</a><br> 是Linux系统保存用户信息及（可能存在）密码（hash）的文件，权限是root用户可读写、shadow组可读。所以一般情况下该文件不可读。</li>
<li>/etc/apache2/*<br> 是Apache的配置文件，可以获知Web目录、服务端口等信息。</li>
<li>/etc/nginx/*<br> 是Nginx配置文件（Ubuntu等系统），可以获知Web目录、服务端口等信息。</li>
<li>/etc/apparmor(.d)/*<br> 是Apparmor配置文件，可以获知各应用系统调用的白名单、黑名单。（如查看MySQL是否禁用系统调用，确定是否可以使用UDF执行系统命令）</li>
<li>/etc/(cron.d/*|crontab)<br> 是定时任务文件。有些题会设置一些定时任务，读取这些配置文件就可以发现隐藏的目录或其它文件。</li>
<li>/etc/environment<br> 是环境变量配置文件之一。环境变量可能存在大量目录信息的泄漏，甚至可能出现secret key泄漏的情况。</li>
<li>/etc/hostname<br> 主机名</li>
<li>/etc/hosts<br> 主机名查询静态表，包含知道域名解析IP的成对信息。通过该文件，可以探测网卡信息和内网IP/域名。</li>
<li>/etc/issue<br> 指明系统版本。</li>
<li>/etc/mysql/*<br> MySQL配置文件。</li>
<li>/etc/php/*<br> PHP配置文件。</li>
<li>/proc目录<br> 通常存储进程动态运行的各种信息，本质上是一种虚拟目录。<br> <em>如果查看非当前进程的信息，pid是可以暴力破解的，如果要查看当前进程，只需/proc/self/代替/proc/[pid]/即可。</em><br> 对应目录下的cmdline可读出比较敏感的信息。<code>/proc/[pid]/cmdline</code><br> 有时我们无法获取当前应用所在的目录，通过cwd命令可以直接跳转到当前目录。<code>/proc/[pid]/cwd/</code><br> 环境变量中可能存在secret_key，也可以通过environ读取。<code>/proc/[pid]/environ</code></li>
<li>其它目录</li>
</ol>

            </div>
        
        <footer class="article-footer">
        </footer>
    </div>
</article>






    
        <article id="post-Notes_HowToHunt-md" class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
                    <div class="article-meta">
                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">读书笔记</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link-link" href="/tags/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/" rel="tag">渗透测试</a>
    </div>

                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/wiki/Notes_HowToHunt-md/">
            <time datetime="2021-04-08T16:05:57.000Z" itemprop="datePublished">2021-04-09</time>
        </a>
    </div>


                        
                            <i class="fa fa-bar-chart"></i>
                            <span id="busuanzi_container_site_pv"><span id="busuanzi_value_page_pv"></span></span>    
                        
                        
                            <div class="article-meta-button">
                                <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Tsunamori/Wiki-site/raw/writing/source/_posts/Notes_HowToHunt-md.md"> Source </a>
                            </div>
                            <div class="article-meta-button">
                                <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Tsunamori/Wiki-site/edit/writing/source/_posts/Notes_HowToHunt-md.md"> Edit </a>
                            </div>
                            <div class="article-meta-button">
                                <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Tsunamori/Wiki-site/commits/writing/source/_posts/Notes_HowToHunt-md.md"> History </a>
                            </div>
                        
                    </div>
                
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/wiki/Notes_HowToHunt-md/">Notes for HowToHunt.md</a>
        </h1>
    

            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
        
            
        
        
            <h2 id="Account-takeover"><a href="#Account-takeover" class="headerlink" title="Account takeover"></a>Account takeover</h2><ol>
<li>Have a session hijacking -&gt; Look for xss to stole the cookies n expand the impact</li>
<li>The target has weak password policy -&gt; Create a (very) weak password n brute force this account to show the POC</li>
<li>Password reset poisoning:<ul>
<li>Go to password reset function -&gt; Enter email n intercept</li>
<li>Change host header to some other host i.e,<pre><code>* Host:target.com
 * Host:attacker.com
</code></pre>
also try to add some headers without changing host like<pre><code>* X-Forwarded-Host: evil.com
 * Referrer: https ://evil.com
</code></pre>
</li>
<li>Forward this if you found that in next request attacker.com means you successfully theft the token.:)</li>
</ul>
</li>
<li>Using CSRF:<ul>
<li>Change Password function</li>
<li>Email change</li>
<li>Change Security Question</li>
</ul>
</li>
<li>Use git recon or google recon to find sensitive data (depends on luck :))</li>
<li>Token leaks in response:<ul>
<li>For registration:<ul>
<li>Intercept the signup request that contains data you have entered.</li>
<li>Click on action -&gt; do -&gt; intercept response to this request.</li>
<li>Click forward.</li>
<li>Check response it that contains any link,any token or otp(one-time password).</li>
</ul>
</li>
<li>For password reset:<ul>
<li>Intercept the forget password option.</li>
<li>Click on action -&gt; do -&gt; intercept response to this request.</li>
<li>Click forward.</li>
<li>Check response it that contains any link,any token or otp.</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="Application-level-DoS"><a href="#Application-level-DoS" class="headerlink" title="Application level DoS"></a>Application level DoS</h2><ol>
<li>Email bounce issues:</li>
</ol>
<p>  <em><strong>ref: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://infosecwriteups.com/an-unexpected-bounty-email-bounce-issues-b9f24a35eb68">https://infosecwriteups.com/an-unexpected-bounty-email-bounce-issues-b9f24a35eb68</a></strong></em></p>
<ol>
<li>Long password DoS:<ul>
<li>Test in Forgot Password Page n Change Password, cuz the registration usually have length limit but others don’t.</li>
<li>Use a password around 150-200 words to check if there has length limit. Then choose a longer password n keep checking the response time, to see if the app crashes for few seconds.</li>
<li>reason: The long password will cause a problem while hashing it for storing in dataset.</li>
</ul>
</li>
<li>Long string DoS:<ul>
<li>Create app and put field like username or address or even profile picture name parameter (second reference) like 1000 character of string .</li>
<li>Search A’s account from B’s account either it will either keeping searching for long time or crash(500 Error code).<br><em><strong>ref: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://shahjerry33.medium.com/long-string-dos-6ba8ceab3aa0">https://shahjerry33.medium.com/long-string-dos-6ba8ceab3aa0</a></strong></em><br><em><strong><a target="_blank" rel="external nofollow noopener noreferrer" href="https://hackerone.com/reports/764434">https://hackerone.com/reports/764434</a></strong></em></li>
</ul>
</li>
</ol>
<h2 id="Authentication-bypass"><a href="#Authentication-bypass" class="headerlink" title="Authentication bypass"></a>Authentication bypass</h2><ol>
<li>2FA bypass<ul>
<li>Response Manipulation<ul>
<li>change the response value of (eg: login) success to ‘true’ from ‘false’</li>
</ul>
</li>
<li>Status Code Manipulation<ul>
<li>change the status code from 4xx to 200 to see if if can bypass</li>
</ul>
</li>
<li>2FA Code Leakage in Response<ul>
<li>check the response of the 2FA Code Triggering Request to see if the code is leaked</li>
</ul>
</li>
<li>JS File Analysis (rare)<ul>
<li>some JS files may contain info about the 2FA code</li>
</ul>
</li>
<li>2FA Code Reusability<ul>
<li>same code can be reused</li>
</ul>
</li>
<li>Lack of Brute-Force Protection<ul>
<li>(possible)</li>
</ul>
</li>
<li>Missing 2FA Code Integrity Validation<ul>
<li>Code for any user acc can be used to bypass the 2FA</li>
</ul>
</li>
<li>CSRF on 2FA Disabling<ul>
<li>signup for two account -&gt; Login into attacker account &amp; capture the disable 2FA request -&gt; generate CSRF POC with .HTML extension -&gt; Login into victim account and fire the request — — -&gt; It disable 2FA which leads to 2FA Bypass.</li>
</ul>
</li>
<li>Password Reset Disable 2FA<ul>
<li>2FA gets disabled on password change/email change</li>
</ul>
</li>
<li>Backup Code Abuse<br><em><strong>ref: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://medium.com/@surendirans7777/2fa-bypass-techniques-32ec135fb7fe">https://medium.com/@surendirans7777/2fa-bypass-techniques-32ec135fb7fe</a></strong></em></li>
<li>Clickjacking on 2FA Disabling Page<ul>
<li>misleading victim to disable the 2FA for the 2FA disabling page</li>
</ul>
</li>
<li>Enabling 2FA doesn’t expire Previously active Sessions<ul>
<li>if the previous session is hijacked n app has session timeout vlun</li>
</ul>
</li>
<li>Bypass 2FA with null or 000000<ul>
<li>enter null or 000000 to bypass</li>
</ul>
</li>
</ul>
</li>
<li>OTP bypass by repeating requests<ul>
<li>create an acc with a non-existing ph num</li>
<li>intercept the request n send to repeater n forward</li>
<li>change the non-existing num to attacker num, get the OTP n register that non-existing num<br><em><strong>ref: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://medium.com/@AGNIHACKERS/otp-bypass-through-response-manipulation-beeb467359d8">https://medium.com/@AGNIHACKERS/otp-bypass-through-response-manipulation-beeb467359d8</a></strong></em></li>
</ul>
</li>
<li>OTP bypass via response manipulation<ul>
<li>change any status, false, error, 0, to true, success, 1. And see if it can bypass the OTP<br><em><strong>ref: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://medium.com/@MAALP/authentication-bypass-using-response-manipulation-6c33eb1257ac">https://medium.com/@MAALP/authentication-bypass-using-response-manipulation-6c33eb1257ac</a></strong></em></li>
</ul>
</li>
</ol>
<h2 id="Broken-link-hijacking"><a href="#Broken-link-hijacking" class="headerlink" title="Broken-link hijacking"></a>Broken-link hijacking</h2><ol>
<li>Broken-link hijacking<ul>
<li>manual check the external link</li>
<li>broken-link-checker<pre><code>* blc -rof --filter-level 3 https://example.com/
</code></pre>
</li>
<li>register the broken link or try to get that username or url</li>
<li>extra ways:<pre><code>* https://ahrefs.com/broken-link-checker
 * https://brokenlinkcheck.com/
</code></pre>
</li>
</ul>
</li>
</ol>
<h2 id="Broken-auth-and-session-management"><a href="#Broken-auth-and-session-management" class="headerlink" title="Broken auth and session management"></a>Broken auth and session management</h2><ol>
<li>Session based bugs<ul>
<li>Old session does not expire<ul>
<li>log in the account through two browser(eg. firefox n chrome)</li>
<li>change pwd or reset pwd on one browser, then refresh the other browser to see if still logged in</li>
</ul>
</li>
<li>Session hijacking (intended behavior)<ul>
<li>login the acc</li>
<li>copy all cookies n logout</li>
<li>paste the cookies n refresh</li>
</ul>
</li>
<li> Password reset link token not expire (insecure configurability)</li>
<li>create acc, request a forget pwd link</li>
<li>don’t use it, instead, change the email to new one</li>
<li>now use the forget pwd link to sent info to the old email n see if pwd is able to change</li>
<li>Server security misconfiguration<ul>
<li>login, play around n logout, goback one page, see if acc is logged in or can view pages limits to the user</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="Bypassing-CSP"><a href="#Bypassing-CSP" class="headerlink" title="Bypassing CSP"></a>Bypassing CSP</h2><ol>
<li>CSP (Content Security Policy) bypass</li>
</ol>
<p>  <em><strong>ref: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/bypassing-csp/csp_bypass">https://kathan19.gitbook.io/howtohunt/bypassing-csp/csp_bypass</a></strong></em></p>
<h2 id="CMS"><a href="#CMS" class="headerlink" title="CMS"></a>CMS</h2><ol>
<li><p>Wordpress</p>
<ul>
<li>Wordpress Detection<ul>
<li>Wappalyzer</li>
<li>WhatRuns</li>
<li>BuildWith</li>
</ul>
</li>
<li>General Scan Tool<ul>
<li>WpScan</li>
</ul>
</li>
<li>xmlrpc.php<ul>
<li>one of the common issue on wp, to get credit, u need to fully exploit n show the impact.</li>
<li>detection:<ul>
<li>site.com/xmlrpc.php</li>
<li>Get the error message about POST request only</li>
</ul>
</li>
<li>exploit<br><em><strong>ref: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://nitesculucian.github.io/2019/07/01/exploiting-the-xmlrpc-php-on-all-wordpress-versions/">https://nitesculucian.github.io/2019/07/01/exploiting-the-xmlrpc-php-on-all-wordpress-versions/</a></strong></em><br><em><strong><a target="_blank" rel="external nofollow noopener noreferrer" href="https://the-bilal-rizwan.medium.com/wordpress-xmlrpc-php-common-vulnerabilites-how-to-exploit-them-d8d3c8600b32">https://the-bilal-rizwan.medium.com/wordpress-xmlrpc-php-common-vulnerabilites-how-to-exploit-them-d8d3c8600b32</a></strong></em><ul>
<li>Intercept the request and change the method GET to POST</li>
<li>List all Methods<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;methodCall&gt;</span><br><span class="line">&lt;methodName&gt;system.listMethods&lt;&#x2F;methodName&gt;</span><br><span class="line">&lt;params&gt;&lt;&#x2F;params&gt;</span><br><span class="line">&lt;&#x2F;methodCall&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li>pingback.ping DDoS</li>
</ul>
</li>
</ul>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;methodCall&gt;</span><br><span class="line">&lt;methodName&gt;pingback.ping&lt;&#x2F;methodName&gt;</span><br><span class="line">&lt;params&gt;&lt;param&gt;</span><br><span class="line">&lt;value&gt;&lt;string&gt;http:&#x2F;&#x2F;&lt;YOUR SERVER &gt;:&lt;port&gt;&lt;&#x2F;string&gt;&lt;&#x2F;value&gt;</span><br><span class="line">&lt;&#x2F;param&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;http:&#x2F;&#x2F;&lt;SOME VALID BLOG FROM THE SITE &gt;&lt;&#x2F;string&gt;</span><br><span class="line">&lt;&#x2F;value&gt;&lt;&#x2F;param&gt;&lt;&#x2F;params&gt;</span><br><span class="line">&lt;&#x2F;methodCall&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>pingback.ping SSRF (internal PORT scan only)</li>
</ul>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;methodCall&gt;</span><br><span class="line">&lt;methodName&gt;pingback.ping&lt;&#x2F;methodName&gt;</span><br><span class="line">&lt;params&gt;&lt;param&gt;</span><br><span class="line">&lt;value&gt;&lt;string&gt;http:&#x2F;&#x2F;&lt;YOUR SERVER &gt;:&lt;port&gt;&lt;&#x2F;string&gt;&lt;&#x2F;value&gt;</span><br><span class="line">&lt;&#x2F;param&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;http:&#x2F;&#x2F;&lt;SOME VALID BLOG FROM THE SITE &gt;&lt;&#x2F;string&gt;</span><br><span class="line">&lt;&#x2F;value&gt;&lt;&#x2F;param&gt;&lt;&#x2F;params&gt;</span><br><span class="line">&lt;&#x2F;methodCall&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>tools<br>xmlrpc-scan <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/nullfil3/xmlrpc-scan">https://github.com/nullfil3/xmlrpc-scan</a></p>
</li>
<li><p>CVE-2018-6389 (wp &lt;= 4.9.3)</p>
<ul>
<li><p>detection</p>
<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://gist.github.com/remonsec/4877e9ee2b045aae96be7e2653c41df9">https://gist.github.com/remonsec/4877e9ee2b045aae96be7e2653c41df9</a></li>
</ul>
</li>
<li><p>exploit</p>
<ul>
<li>use DDoS (Doser <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/quitten/doser.py">https://github.com/quitten/doser.py</a>)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 doser.py -t 999 -g &#39;https:&#x2F;&#x2F;site.com&#x2F;fullUrlFromLoadsxploit&#39;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>WP Cornjob DOS</p>
<ul>
<li><p>detection</p>
<ul>
<li>view site.com/wp-cron.php, You will see a Blank page with 200 HTTP status code</li>
</ul>
</li>
<li><p>exploit</p>
<ul>
<li>same tool as above (Doser)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">You will see a Blank page with 200 HTTP status code</span><br></pre></td></tr></table></figure>
<p><em><strong>ref: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://medium.com/@thecpanelguy/the-nightmare-that-is-wpcron-php-ae31c1d3ae30">https://medium.com/@thecpanelguy/the-nightmare-that-is-wpcron-php-ae31c1d3ae30</a></strong></em></p>
</li>
</ul>
</li>
<li><p>WP User Enumeration</p>
<ul>
<li>site.com/wp-json/wp/v2/users/</li>
<li>mostly not acceptable, can be used to extend the impact tho</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h2><ol>
<li>CORS (<em><strong>ref: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.packetlabs.net/cross-origin-resource-sharing-cors/">https://www.packetlabs.net/cross-origin-resource-sharing-cors/</a></strong></em>)</li>
</ol>
<ul>
<li>misconfigured CORS<ul>
<li>hunting method 1 (single target)<ul>
<li>crawl the target website n search Access-Control using burp</li>
<li>Try to add Origin Header i.e, Origin:attacker.com or Origin:null or Origin:attacker.target.com or Origin:target.attacker.com</li>
<li>If origin is reflected in response means the target is vuln to CORS</li>
</ul>
</li>
<li>hunting method 2 (multiple means including subdomains)<ul>
<li>find alive subdomains (i.e, subfinder -d domain.com -o target.txt; grep alive: cat target.txt | httpx | tee -a alive.txt), send each subdomain into burp</li>
<li>same as above method</li>
</ul>
</li>
<li>automated tools<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/chenjj/CORScanner">https://github.com/chenjj/CORScanner</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/lc/theftfuzzer">https://github.com/lc/theftfuzzer</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/s0md3v/Corsy">https://github.com/s0md3v/Corsy</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/Shivangx01b/CorsMe">https://github.com/Shivangx01b/CorsMe</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ol start="2">
<li>CORS bypass</li>
</ol>
<ul>
<li>Origin:null</li>
<li>Origin:attacker.com</li>
<li>Origin:attacker.target.com</li>
<li>Origin:attackertarget.com</li>
<li>Origin:sub.attackertarget.com</li>
<li>Origin:attacker.com and then change the method Get to post/Post to Get</li>
<li>Origin:sub.attacker target.com</li>
<li>Origin:sub.attacker%target.com</li>
<li>Origin:attacker.com/target.com</li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://twitter.com/trbughunters/status/1287023673845612546">https://twitter.com/trbughunters/status/1287023673845612546</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://twitter.com/Paresh_parmar1/status/1265251507655630848">https://twitter.com/Paresh_parmar1/status/1265251507655630848</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://www.corben.io/tricky-CORS/">https://www.corben.io/tricky-CORS/</a></li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://medium.com/@virus0x01/cors-misconfiguration-leading-to-private-information-disclosure-3034cfcb4b93">https://medium.com/@virus0x01/cors-misconfiguration-leading-to-private-information-disclosure-3034cfcb4b93</a></li>
</ul>
<h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h2><ol>
<li>CSRF<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/csrf/csrf">https://kathan19.gitbook.io/howtohunt/csrf/csrf</a></li>
</ul>
</li>
<li>CSRF bypass<ul>
<li>-Change Request Method [POST =&gt; GET]</li>
<li>-Remove Total Token Parameter</li>
<li>-Remove The Token, And Give a Blank Parameter</li>
<li>-Copy a Unused Valid Token , By Dropping The Request and Use That Token</li>
<li>-Use Own CSRF Token To Feed it to Victim</li>
<li>-Replace Value With Of A Token of Same Length</li>
<li>-Reverse Engineer The Token</li>
<li>-Extract Token via HTML injection</li>
<li>-Switch From Non-Form <code>Content-Type: application/json</code> or <code>Content-Type: application/x-url-encoded</code> To <code>Content-Type: form-multipart</code></li>
<li>-Change/delete the last or frist character from the token</li>
<li>-Change referrer to Referrer</li>
<li>-Bypass the regex<ul>
<li>If the site is looking for “bank.com” in the referer URL, maybe “bank.com.attacker.com” or “attacker.com/bank.com” will work.</li>
</ul>
</li>
<li>-Remove the referer header (add this <meta name="”referrer”" content="”no-referrer”"> in your payload or html code)</li>
<li>-Clickjacking (<a target="_blank" rel="external nofollow noopener noreferrer" href="https://owasp.org/www-community/attacks/Clickjacking">https://owasp.org/www-community/attacks/Clickjacking</a>)<ul>
<li>Exploiting clickjacking on the same endpoint bypasses all CSRF protection. Because technically, the request is indeed originating from the legitimate site. If the page where the vulnerable endpoint is located on is vulnerable to clickjacking, all CSRF protection will be rendered irrelevant and you will be able to achieve the same results as a CSRF   attack on the endpoint, albeit with a bit more effort.</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="Finding-CVEs"><a href="#Finding-CVEs" class="headerlink" title="Finding CVEs"></a>Finding CVEs</h2><ol>
<li>CVEs<br>   1.Grab all the subdomains i.e, subfinder -d domain.com | tee -a domains.txt<br>   2.Grap all alive domains i.e,  cat domains.txt | httpx -status-code | grep 200 | cut -d “ “ -f1 | tee -a alive.txt<br>   3.Run nuclei basic-detection,panels,workflows,cves templates differently and store results in different file. i.e, cat alive.txt | nuclei -t nuclei-templates/workflows | tee -a workflows.<br>   4.Read each output carefully with patience.<br>   5.Find interest tech used by target. i.e, jira<br>   6.put that link into browser check the version used by target.<br>   7.Go on google search with jira version exploit.<br>   8.grep the cves<br>   9.Go to twitter in explore tab search CVE(that you found from google) poc or CVE exploit<br>   10.Go to google and put cve or some details grab from   twitter for a better poc read writeups related to that.<br>   11.Try all cves if success report it.:)</li>
</ol>
<h2 id="Check-list"><a href="#Check-list" class="headerlink" title="Check list"></a>Check list</h2><ol>
<li>Web application pentesting checklist<br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/checklist/web-application-pentesting-checklist">https://kathan19.gitbook.io/howtohunt/checklist/web-application-pentesting-checklist</a></li>
<li>Web checklist 2<br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/KathanP19/HowToHunt/blob/master/CheckList/Web_Checklist_by_Chintan_Gurjar.pdf">https://github.com/KathanP19/HowToHunt/blob/master/CheckList/Web_Checklist_by_Chintan_Gurjar.pdf</a></li>
<li>Web checklist 3<br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/KathanP19/HowToHunt/blob/master/CheckList/mindmap.png">https://github.com/KathanP19/HowToHunt/blob/master/CheckList/mindmap.png</a></li>
</ol>
<h2 id="Source-code-review"><a href="#Source-code-review" class="headerlink" title="Source code review"></a>Source code review</h2><ol>
<li>code review tips<ul>
<li>important functions first<br>When reading source code, focus on important functions such as authentication, password reset, state-changing actions and sensitive info reads. (What is the most important would depend on the application.) Then, review how these components interact with other functionality. Finally, audit other less sensitive parts of the application.</li>
<li>follow user input<br>Another approach is to follow the code that processes user input. User input such as HTTP request parameters, HTTP headers, HTTP request paths, database entries, file reads, and file uploads provide the entry points for attackers to exploit the application’s vulnerabilities.This may also help us to find some critical vulnerabilities like xxe,xxs,sql injection</li>
<li>hard-coded secrets n credentials<br>Hard-coded secrets such as API keys, encryption keys and database passwords can be easily discovered during a source code review. You can grep for keywords such as “key”, “secret”, “password”, “encrypt” or regex search for hex or base64 strings (depending on the key format in use).</li>
<li>use of dangerous functions n outdated dependencies<br>Unchecked use of dangerous functions and outdated dependencies are a huge source of bugs. Grep for specific functions for the language you are using and search through the dependency versions list to see if they are outdated.</li>
<li>developer comments, hidden debug functionalities, configuration files, and the .git directory<br>These are things that developers often forget about and they leave the application in a dangerous state. Developer comments can point out obvious programming mistakes, hidden debug functionalities often lead to privilege escalation, config files allow attackers to gather more information about your infrastructure and finally, an exposed .git directory allows attackers to reconstruct your source code.</li>
<li>hidden paths, deprecated endpoints, and endpoints in development<br>These are endpoints that users might not encounter when using the application normally. But if they work and they are discovered by an attacker, it can lead to vulnerabilities such as authentication bypass and sensitive information leak, depending on the exposed endpoint.</li>
<li>weak cryptography or hashing algorithms<br>This is an issue that is hard to find during a black-box test, but easy to spot when reviewing source code. Look for issues such as weak encryption keys, breakable encryption algorithms, and weak hashing algorithms. Grep for terms like ECB, MD4, and MD5.</li>
<li>missing security checks on user input and regex strength<br>Reviewing source code is a great way to find out what kind of security checks are missing. Read through the application’s documentation and test all the edge cases that you can think of. A great resource for what kind of edge cases that you should consider is PayloadsAllTheThings.(github)</li>
<li>missing cookie flags<br>Look out for missing cookie flags such as httpOnly and secure.</li>
<li>unexpected behavior, conditionals, unnecessarily complex and verbose functions<br>Additionally, pay special attention to the application’s unexpected behavior, conditionals, and complex functions. These locations are where obscure bugs are often discovered.</li>
</ul>
</li>
</ol>
<h2 id="EXIF-geo-data-not-stripped"><a href="#EXIF-geo-data-not-stripped" class="headerlink" title="EXIF geo data not stripped"></a>EXIF geo data not stripped</h2><ol>
<li>EXIF geo data not stripped (sensitive info leaked)<ul>
<li>tools<br><a target="_blank" rel="external nofollow noopener noreferrer" href="http://exif.regex.info/exif.cgi">http://exif.regex.info/exif.cgi</a></li>
</ul>
</li>
</ol>
<h2 id="File-upload-bypass"><a href="#File-upload-bypass" class="headerlink" title="File upload bypass"></a>File upload bypass</h2><ol>
<li>File upload bypass<ul>
<li>bypassing normal extension<br>  sth.php.jpg or sth.jpg.php</li>
<li>bypassing the magic byte validation<br>  polyglots</li>
</ul>
</li>
</ol>
<h2 id="Find-origin-IP"><a href="#Find-origin-IP" class="headerlink" title="Find origin IP"></a>Find origin IP</h2><ol>
<li>find origin<ul>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/find-origin-ip/findorigin">https://kathan19.gitbook.io/howtohunt/find-origin-ip/findorigin</a></li>
</ul>
</li>
</ol>
<h2 id="HTTP-desync-attack"><a href="#HTTP-desync-attack" class="headerlink" title="HTTP desync attack"></a>HTTP desync attack</h2><ol>
<li>HTTP_Desync<ul>
<li>HTTP request smuggling<ul>
<li>how to do<br>ref: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://portswigger.net/web-security/request-smuggling/finding">https://portswigger.net/web-security/request-smuggling/finding</a><br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://portswigger.net/web-security/request-smuggling/exploiting">https://portswigger.net/web-security/request-smuggling/exploiting</a><br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn">https://portswigger.net/research/http-desync-attacks-request-smuggling-reborn</a><br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://paper.seebug.org/1048/">https://paper.seebug.org/1048/</a></li>
<li>tools<br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/defparam/smuggler">https://github.com/defparam/smuggler</a><br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/PortSwigger/http-request-smuggler">https://github.com/PortSwigger/http-request-smuggler</a></li>
<li>testing lab<br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://portswigger.net/web-security/request-smuggling">https://portswigger.net/web-security/request-smuggling</a></li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="Host-header-attack"><a href="#Host-header-attack" class="headerlink" title="Host-header attack"></a>Host-header attack</h2><ol>
<li>host-header<br> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/host-header-attack/host-header">https://kathan19.gitbook.io/howtohunt/host-header-attack/host-header</a></li>
</ol>
<h2 id="HTML-injection"><a href="#HTML-injection" class="headerlink" title="HTML-injection"></a>HTML-injection</h2><ol>
<li><p>HTML-injection</p>
<ul>
<li><p>Password reset links are usually addressed to your account name followed by the reset link. Also if the application allows you to have your account name with tags and special characters then you should try this.</p>
</li>
<li><p>steps</p>
<ul>
<li>Create ur acc, edit the name to<code>&lt;h1&gt;attacker&lt;/h1&gt;</code> or <code>&quot;abc&gt;&lt;h1&gt;attacker&lt;/h1&gt;</code><br>and save it.</li>
<li>request a password reset n check the reset email.</li>
<li>see if the <code>&lt;h1&gt;</code> tag executed.</li>
</ul>
</li>
<li><p>tips</p>
<ul>
<li><p>HTML injection are usually considered as low to medium severity bugs but you can escalate the severity by serving a malicious link by using <code>&lt;a href&gt;</code> for eg:<br><code>&lt;h1&gt;attacker&lt;/h1&gt;&lt;a href=&quot;your-controlled-domain&quot;Click here&lt;/a&gt;</code></p>
</li>
<li><p>You can redirect the user to your malicious domain and serve a fake reset password page to steal credentials Also you can serve a previously found XSS page and steal user cookies etc.</p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="IDOR"><a href="#IDOR" class="headerlink" title="IDOR"></a>IDOR</h2><ol>
<li>IDOR<br> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/idor/idor">https://kathan19.gitbook.io/howtohunt/idor/idor</a></li>
</ol>
<h2 id="JWT-attack"><a href="#JWT-attack" class="headerlink" title="JWT attack"></a>JWT attack</h2><ol>
<li>JWT<br> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/jwt-attack/jwt_attack">https://kathan19.gitbook.io/howtohunt/jwt-attack/jwt_attack</a></li>
</ol>
<h2 id="MFA-bypass"><a href="#MFA-bypass" class="headerlink" title="MFA bypass"></a>MFA bypass</h2><ol>
<li>MFA bypasses<br> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/mfa-bypass/mfa_bypasses">https://kathan19.gitbook.io/howtohunt/mfa-bypass/mfa_bypasses</a></li>
<li>2FA bypass<br> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/mfa-bypass/2fa_bypass">https://kathan19.gitbook.io/howtohunt/mfa-bypass/2fa_bypass</a></li>
</ol>
<h2 id="Misconfigurations"><a href="#Misconfigurations" class="headerlink" title="Misconfigurations"></a>Misconfigurations</h2><ol>
<li><p>default credential n admin panel</p>
<ul>
<li>default credentials basics<br>default software configurations, ie.:</li>
</ul>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.target.com&#x2F;admin</span><br><span class="line">https:&#x2F;&#x2F;www.target.com&#x2F;admin-console</span><br><span class="line">https:&#x2F;&#x2F;www.target.com&#x2F;console</span><br><span class="line">https:&#x2F;&#x2F;admin.target.com</span><br><span class="line">https:&#x2F;&#x2F;admin-console.target.com</span><br><span class="line">https:&#x2F;&#x2F;console.target.com</span><br></pre></td></tr></table></figure>

<ul>
<li>get access from third party<ul>
<li>search the service default credentials if the admin is working on a third party</li>
</ul>
</li>
<li>bypass to get access to login page<ul>
<li>when visiting admin login page is denied, use header injection to bypass, eg, <code>X-Orginal-URL: /admin</code> or <code>X-Rewrite-URL:/admin</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="OAuth"><a href="#OAuth" class="headerlink" title="OAuth"></a>OAuth</h2><ol>
<li>OAuth<br> <a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/oauth/oauth">https://kathan19.gitbook.io/howtohunt/oauth/oauth</a></li>
</ol>
<h2 id="Open-redirection"><a href="#Open-redirection" class="headerlink" title="Open redirection"></a>Open redirection</h2><ol>
<li>find OpenRedirect trick<ul>
<li>steps<ul>
<li>create an acc, record the user profile link, logout n clean all the cookies.</li>
<li>paste n visit the profile link, it may redirect u to the login like <code>https://samplesite.me/login?next=accounts/profile</code> or <code>https://samplesite.me/login?retUrl=accounts/profile</code></li>
<li>try to exploit the parameter by adding an external domain eg: <code>https://samplesite.me/login?next=https://evil.com/</code> or <code>https://samplesite.me/login?next=https://samplesite.me@evil.com/ #</code>or <code>https://targetweb.com?url=www.targetweb.com.attackersite.com (with created subdomain)</code> (to beat the bad regex filter)</li>
<li>else, try the XSS eg: <code> https://samplesite.me/login?next=javascript:alert(1);//</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="Parameter-pollution"><a href="#Parameter-pollution" class="headerlink" title="Parameter pollution"></a>Parameter pollution</h2><ol>
<li>Parameter pollution in social sharing buttons<ul>
<li>find a social sharing button n get the sharing link.</li>
<li>modified it from <code>https://taget.com/how-to-hunt </code> to such as <code>https://taget.com/how-to-hunt?&amp;u=https://attacker.com/vaya&amp;text=another_site:https://attacker.com/vaya</code></li>
<li>click the share button n see if the attack website is in the sharing content<h2 id="Password-reset-functionality"><a href="#Password-reset-functionality" class="headerlink" title="Password reset functionality"></a>Password reset functionality</h2>Mindmap <a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/password-reset-functionality/password_reset_functionality">https://kathan19.gitbook.io/howtohunt/password-reset-functionality/password_reset_functionality</a></li>
</ul>
</li>
<li>password reset token leakage<ol>
<li>Sent a password reset request using forget password</li>
<li>Check your email</li>
<li>Copy your reset page link and paste in another tab and make burp intercept on.</li>
<li>Look for every request if you find similar token that is in reset link with other domain like: bat.bing.com or facebook.com</li>
<li>Then there is reset password token leakage.</li>
</ol>
</li>
<li>account takeover by password reset functionality<ol>
<li>email= <a href="mailto:&#118;&#105;&#x63;&#116;&#105;&#x6d;&#x40;&#103;&#109;&#97;&#105;&#x6c;&#46;&#x63;&#111;&#109;">&#118;&#105;&#x63;&#116;&#105;&#x6d;&#x40;&#103;&#109;&#97;&#105;&#x6c;&#46;&#x63;&#111;&#109;</a>&amp;email=attacker@gmil.com</li>
<li>email= <a href="mailto:&#118;&#x69;&#x63;&#116;&#x69;&#x6d;&#x40;&#x67;&#109;&#97;&#x69;&#x6c;&#46;&#x63;&#111;&#109;">&#118;&#x69;&#x63;&#116;&#x69;&#x6d;&#x40;&#x67;&#109;&#97;&#x69;&#x6c;&#46;&#x63;&#111;&#109;</a>%20email=attacker@gmil.com</li>
<li>email= <a href="mailto:&#x76;&#x69;&#x63;&#x74;&#x69;&#109;&#x40;&#103;&#109;&#x61;&#x69;&#108;&#46;&#x63;&#111;&#109;">&#x76;&#x69;&#x63;&#x74;&#x69;&#109;&#x40;&#103;&#109;&#x61;&#x69;&#108;&#46;&#x63;&#111;&#109;</a> |email=attacker@gmil.com</li>
<li>email= <a href="mailto:&#x76;&#105;&#x63;&#116;&#105;&#109;&#64;&#x67;&#109;&#97;&#105;&#x6c;&#x2e;&#99;&#x6f;&#109;">&#x76;&#105;&#x63;&#116;&#105;&#109;&#64;&#x67;&#109;&#97;&#105;&#x6c;&#x2e;&#99;&#x6f;&#109;</a>%0d%0acc:<a href="mailto:&#97;&#x74;&#x74;&#x61;&#99;&#107;&#x65;&#114;&#x40;&#103;&#x6d;&#105;&#108;&#x2e;&#x63;&#111;&#x6d;">&#97;&#x74;&#x74;&#x61;&#99;&#107;&#x65;&#114;&#x40;&#103;&#x6d;&#105;&#108;&#x2e;&#x63;&#111;&#x6d;</a></li>
<li>email= <a href="mailto:&#118;&#105;&#99;&#x74;&#105;&#x6d;&#x40;&#x67;&#x6d;&#97;&#x69;&#x6c;&#46;&#x63;&#111;&#x6d;">&#118;&#105;&#99;&#x74;&#105;&#x6d;&#x40;&#x67;&#x6d;&#97;&#x69;&#x6c;&#46;&#x63;&#111;&#x6d;</a>&amp;code= my password reset token</li>
</ol>
</li>
</ol>
<h2 id="Rate-limit"><a href="#Rate-limit" class="headerlink" title="Rate limit"></a>Rate limit</h2><ol>
<li><p>rate-limit bypass</p>
<ul>
<li><p>customizing HTTP methods</p>
<ul>
<li><p>change the GET request to POST, PUT, etc.</p>
</li>
<li><p>bypassing rate-limit in API’s try HEAD method</p>
</li>
<li><p>using header to bypass the rate limit<br>(use the following just below the host header)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded-For: IP</span><br><span class="line">X-Forwarded-IP: IP</span><br><span class="line">X-Client-IP: IP</span><br><span class="line">X-Remote-IP: IP</span><br><span class="line">X-Originating-IP: IP</span><br><span class="line">X-Host: IP</span><br><span class="line">X-Client: IP</span><br><span class="line"></span><br><span class="line">#or use double X-Forwarded-For header</span><br><span class="line">X-Forwarded-For:</span><br><span class="line">X-Forwarded-For: IP</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>addding headers to spoof IP</p>
<ul>
<li>add HTTP headers to spoof IP n evade detection</li>
</ul>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">X-Forwarded: 127.0.0.1</span><br><span class="line">X-Forwarded-By: 127.0.0.1</span><br><span class="line">X-Forwarded-For: 127.0.0.1</span><br><span class="line">X-Forwarded-For-Original: 127.0.0.1</span><br><span class="line">X-Forwarder-For: 127.0.0.1</span><br><span class="line">X-Forward-For: 127.0.0.1</span><br><span class="line">Forwarded-For: 127.0.0.1</span><br><span class="line">Forwarded-For-Ip: 127.0.0.1</span><br><span class="line">X-Custom-IP-Authorization: 127.0.0.1</span><br><span class="line">X-Originating-IP: 127.0.0.1</span><br><span class="line">X-Remote-IP: 127.0.0.1</span><br><span class="line">X-Remote-Addr: 127.0.0.1</span><br></pre></td></tr></table></figure>

<ul>
<li>bypass rate limit using special characters<ul>
<li>adding null byte (%00) at the end of the email</li>
<li>try add a space after the email (not encoded)</li>
<li>other characters can be tried to bypass rate limit <code>%0d , %2e , %09 , %20 , %0, %00, %0d%0a, %0a, %0C</code></li>
<li>add a slash (/) at the end of api endpoint<br>from<code>domain.com/v1/login</code> to <code>domain.com/v1/login/</code><br>eg: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://hackerone.com/reports/1067533">https://hackerone.com/reports/1067533</a></li>
</ul>
</li>
<li>using IP rotate burp extension<br>other ref: <a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/rate-limit/ratelimitbypass">https://kathan19.gitbook.io/howtohunt/rate-limit/ratelimitbypass</a></li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="Recon"><a href="#Recon" class="headerlink" title="Recon"></a>Recon</h2><ol>
<li>recon workflow<br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/recon/workflow">https://kathan19.gitbook.io/howtohunt/recon/workflow</a></li>
<li>subdomain enumeration<br><a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/recon/subdomain_enumeration">https://kathan19.gitbook.io/howtohunt/recon/subdomain_enumeration</a></li>
</ol>
<h2 id="SQLI"><a href="#SQLI" class="headerlink" title="SQLI"></a>SQLI</h2><ol>
<li>SQL injection<ul>
<li>send request to burp scanner n proceed with active scan</li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://twitter.com/El3ctr0Byt3s/status/1302706241240731649">https://twitter.com/El3ctr0Byt3s/status/1302706241240731649</a></li>
<li>for getting hidden parameters<ol>
<li>Use subdomain enumeration tools on the domain.</li>
<li>Gather all urls using hakcrawler, waybackurls, gau for the domain and subdomains.</li>
<li>You can use the same method described above in 2nd point.</li>
<li>Use Arjun to scan for the hidden params in the urls.</li>
<li>Use –urls flag to include all urls.</li>
<li>Check the params as <a target="_blank" rel="external nofollow noopener noreferrer" href="https://domain.com/?%60">https://domain.com?`</a><hiddenparam>=<value>`</value></hiddenparam></li>
<li>Send request to file and process it through sqlmap.</li>
</ol>
</li>
<li><a target="_blank" rel="external nofollow noopener noreferrer" href="https://kathan19.gitbook.io/howtohunt/sqli/sql_injection">https://kathan19.gitbook.io/howtohunt/sqli/sql_injection</a></li>
</ul>
</li>
</ol>

            </div>
        
        <footer class="article-footer">
        </footer>
    </div>
</article>






    
        <nav id="page-nav">
        <a class="extend prev" rel="prev" href="/">&amp;laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
        </nav>
    
</section>
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            Tsunamori &copy; 2023 
            <a rel="external nofollow noopener noreferrer" target="_blank" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/80x15.png"></a>
            <br> Powered by <a href="http://hexo.io/" target="_blank" rel="external nofollow noopener noreferrer">Hexo</a>. Theme - <a target="_blank" rel="external nofollow noopener noreferrer" href="https://github.com/zthxxx/hexo-theme-Wikitten">wikitten</a>
            
                <br>
                <span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i> <span id="busuanzi_value_site_pv"></span></span>
                &nbsp;|&nbsp;
                <span id="busuanzi_container_site_pv"><i class="fa fa-user"></i> <span id="busuanzi_value_site_uv"></span></span>
            
        </div>
    </div>
</footer>

        

    
        
<script src="/libs/lightgallery/js/lightgallery.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-pager.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-zoom.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-hash.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-share.min.js"></script>

        
<script src="/libs/lightgallery/js/lg-video.min.js"></script>

    
    
        
<script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>

    
    
        <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true,
            TeX: {
                equationNumbers: {
                  autoNumber: 'AMS'
                }
            }
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script async src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    



<!-- Custom Scripts -->

<script src="/js/main.js"></script>


    </div>
</body>
</html>